--1.How many users are there?

SELECT 
  COUNT(DISTINCT (user_id)) AS UserNum
FROm users

--2. How many cookies does each user have on average?

WITH CTE_A AS (
SELECT
  user_id
, COUNT(cookie_id) AS CCount
FROM users
GROUP BY user_id
)
SELECT 
  AVG(CCount*1.00) AS AVGCCount
FROM CTE_A

--3. What is the unique number of visits by all users per month?

SELECT
    DISTINCT MONTH(event_time) AS MONTH
,   COUNT(DISTINCT visit_id)   AS COUNT
FROM events
GROUP BY MONTH(event_time)
ORDER BY MONTH

--4. What is the number of events for each event type? 

SELECT
    DISTINCT event_name
,   COUNT(*) AS Count
FROM Events E
JOIN event_identifier EI
ON E.event_type=EI.event_type
GROUP BY event_name

